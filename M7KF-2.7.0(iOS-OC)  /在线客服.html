<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>在线客服</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>


</head>

<body>

<h1 id="toc_0">客服SDK集成文档（iOS）</h1>

<h2 id="toc_1">1、SDK工作流程</h2>

<p><img src="https://fs-kefu-sdk.7moor.com/flow_chart.jpg" alt="Alt text"></p>

<h2 id="toc_2">2、准备工作</h2>

<h3 id="toc_3">2.1 文件说明</h3>

<table>
<thead>
<tr>
<th>文件</th>
<th>说明</th>
</tr>
</thead>

<tbody>
<tr>
<td>IMSDK-OC</td>
<td>使用Objective-C编写UI界面的demo, 快速集成可使用此demo</td>
</tr>
<tr>
<td>QMChatSDK</td>
<td>在线客服核心库、可以通过pod<font color=red>动态引用(视频版暂时不支持)</font></td>
</tr>
<tr>
<td>Qiniu</td>
<td>在线客服文件存储的第三方库, 使用SDK需要依赖此库(内含:AFNetworking、HappyDNS)、可以通过pod<font color=red>动态引用</font></td>
</tr>
<tr>
<td>FMDB</td>
<td>在线客服数据持久化的第三方库, 使用SDK需要依赖此库、可以通过pod<font color=red>动态引用</font></td>
</tr>
<tr>
<td>Release</td>
<td>只支持真机(armv7、arm64等)的动态库</td>
</tr>
<tr>
<td>真机+模拟器</td>
<td>同时支持真机和模拟器(i386、x86_64)的动态库, 应用发布使用此版本需要添加脚本</td>
</tr>
</tbody>
</table>

<h3 id="toc_4">2.2 开发环境</h3>

<p>Xcode版本 -&gt; 9.3(9E145),  9.4.1(9F2000)</p>

<p>QMChatSDK版本 -&gt; 2.5.1</p>

<p>Qiniu版本 -&gt; 7.1.8</p>

<p>AFNetworking版本 -&gt; 3.1.0</p>

<p>FMDB版本 -&gt; 2.7.2</p>

<p>HappyDNS版本 -&gt; 0.3.10</p>

<p><font color=red> iOS版本最低支持8.0, 最高支持11.4 (视频版最低支持9.0)</font></p>

<h3 id="toc_5">2.3 下载地址</h3>

<p>https://fs-kefu-sdk.7moor.com/M7KF-2.6.0%28iOS-OC%29%20%20.zip</p>

<h2 id="toc_6">3、快速集成</h2>

<p><font color=red>注: 集成和发布过程有问题，请看文档最后的常见问题</font></p>

<h3 id="toc_7">3.1 导入SDK</h3>

<p>把IMSDK-OC中的Framework(FMDB.framework、QMChatSDK.framework、Qiniu.framework)拷贝到工程路径下, 右键工程目录, 选择Add Files to &quot;工程名&quot;</p>

<h3 id="toc_8">3.2 集成Demo</h3>

<p>QMChatRoom: 聊天界面及部分工具类</p>

<p>Resources: 表情资源文件</p>

<p>Assets: 其他图片资源</p>

<p>Vendors: 第三方库</p>

<p>PrefixHeader: 头文件</p>

<p><font color=red>注: 可选择性导入工程</font></p>

<h3 id="toc_9">3.3 配置xcode(重要)</h3>

<ul>
<li>General配置（动态库需要添加依赖）</li>
</ul>

<p>Embedded Binaries,展开 Embedded Binaries 后
点击展开后下面的 + 来添加framework</p>

<p><img src="https://fs-kefu-sdk.7moor.com/setDynamicLibrary1.png" alt="Alt text"></p>

<ul>
<li>Build Settings配置 (支持swift、不支持bitcode)</li>
</ul>

<p><font color=red> Build Options -&gt; Always Embed Swift Standard Libraries 选择Yes</font></p>

<p><font color=red> Build Options -&gt; Enable Bitcode 选择No</font></p>

<ul>
<li>Info.plist配置 (允许http、获取权限)</li>
</ul>

<p><img src="https://fs-kefu-sdk.7moor.com/setNewInfo.png" alt="Alt text"></p>

<h3 id="toc_10">3.4 注册SDK</h3>

<ul>
<li>初始化SDK</li>
</ul>

<p>AppKey: 在后台SDK下载界面的下方, 是接入在线客服的唯一凭证 
userName: 可以区分不同用户的用户名称, 可以显示在后台客服界面<br>
userId: 可以区分不同用户接入在线客服, 不同用户用户ID一定不同</p>

<p><font color=red>注: userId 只能使用字母、数字及下划线、否则会初始化失败, AppKey、userName、userId都是必填项</font></p>

<div><pre><code class="language-none">[QMConnect registerSDKWithAppKey:@&quot;注册App的AppKey&quot; userName:@&quot;用户名&quot; userId:@&quot;1234&quot;];</code></pre></div>

<h6 id="toc_11">注：进行任何操作必须是注册AppKey成功的状态</h6>

<ul>
<li>AppKey获取方法</li>
</ul>

<p><img src="https://fs-kefu-sdk.7moor.com/liucheng.png" alt="Alt text"></p>

<ul>
<li>监听注册状态</li>
</ul>

<p>监听SDK初始化的状态需要注册广播:  </p>

<p>CUSTOM<em>LOGIN</em>SUCCEED: 注册成功的时候广播的名字, SDK其他的接口操作都基于注册成功的状态才能进行, 如获取部门、或技能组的接口<br>
CUSTOM<em>LOGIN</em>ERROR_USER: 注册失败时候广播的名字, 具体失败的原因提示:<br>
1、accessId is Empty: appKey不可以为空值  </p>

<p>2、userName is Empty: userName不可以为空值  </p>

<p>3、userId is not match: userId不可以为空值 </p>

<p>4、Create Socket Error: 建立连接失败</p>

<p>5、Connect Socket Error: 连接服务器失败</p>

<p>6、5: 服务器状态异常</p>

<p>7、400: appKey错误或不存在</p>

<p>8、服务端返回其他类型错误</p>

<div><pre><code class="language-none">[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(loginSuccess:) name:CUSTOM_LOGIN_SUCCEED object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(loginFaile:) name:CUSTOM_LOGIN_ERROR_USER object:nil];</code></pre></div>

<h2 id="toc_12">4、API接口</h2>

<h3 id="toc_13">4.1 自建服务器设置网络地址</h3>

<p>是不是自建服务器的用户不需要设置此项，此接口应在注册之前使用</p>

<div><pre><code class="language-none">[QMConnect setServerAddress:@&quot;IP地址&quot; tcpPort:@&quot;端口&quot; httpPost:@&quot;TCP地址&quot;];</code></pre></div>

<h3 id="toc_14">4.2 获取渠道全局配置</h3>

<p>获取全局配置,主要用于区分下一步操作<font color=red>日程管理</font>和<font color=red>技能组</font>(如果不配置日程管理的可跳过此步骤，直接获取技能组信息)</p>

<div><pre><code class="language-none">[QMConnect sdkGetWebchatGlobleConfig:^(NSDictionary * _Nonnull scheduleDic) {
    //获取渠道全局配置字典
} failBlock:^{
    //获取信息失败
}];

注册成功自动获取后台配置信息并写入本地plist文件</code></pre></div>

<h3 id="toc_15">4.3 获取配置信息(开启日程管理时用到)</h3>

<div><pre><code class="language-none">[QMConnect sdkGetWebchatScheduleConfig:^(NSDictionary * _Nonnull scheduleDic) {
    //获取配置信息成功
} failBlock:^{
   //获取配置信息失败 
}];</code></pre></div>

<h3 id="toc_16">4.4 获取部门信息（技能组）</h3>

<p>后台可配置多个部门/技能组(如: 售前、售后等), SDK注册成功后, 调用此接口获取后台配置好的部门信息, 用户将选择对应的部门进行问题咨询,     </p>

<div><pre><code class="language-none">[QMConnect sdkGetPeers:^(NSArray * _Nonnull peerArray) {
    // 获取部门信息的数组
 } failureBlock:^{
    // 获取信息失败
}];</code></pre></div>

<p>技能组包含部门ID和部门Name两个属性, 只有一个部门可以不提示选择框, 直接进入聊天界面</p>

<h3 id="toc_17">4.5 开始会话</h3>

<p>进入聊天界面, 首先调用开始会话接口, 成功后才能获取坐席状态, 及消息的收发, 参数为刚刚选择的部门ID, 回调是否开启评价选择项 </p>

<div><pre><code class="language-none">[QMConnect sdkBeginNewChatSession:self.peerId successBlock:^(BOOL remark)   {
   // 开始会话成功, 评价开关
} failBlock:^{
    // 开始会话失败
}];</code></pre></div>

<p>开始会话带专属坐席（不能配置机器人）</p>

<div><pre><code class="language-none">[QMConnect sdkBeginNewChatSession:self.peerId params:@{@&quot;agent&quot;: @&quot;8000&quot;} successBlock:^(BOOL remark) {
    // 开始会话成功, 评价开关    
 } failBlock:^{
  // 开始会话失败
}];</code></pre></div>

<p>开始会话(日程管理专用) </p>

<div><pre><code class="language-none">[QMConnect sdkBeginNewChatSessionSchedule: self.scheduleId processId: self.processId currentNodeId: self.currentNodeId params: @{@&quot;&quot;:@&quot;&quot;} successBlock:^(BOOL remark) {
    // 开始会话成功, 评价开关
 } failBlock:^{
    // 开始会话失败
 }];</code></pre></div>

<p>会话状态(以广播的形式推送给移动端)</p>

<div><pre><code class="language-none">[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(robotAction) name:ROBOT_SERVICE object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(customOnline) name:CUSTOMSRV_ONLINE object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(customOffline) name:CUSTOMSRV_OFFLINE object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(customClaim) name:CUSTOMSRV_CLAIM object:nil];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(customFinish) name:CUSTOMSRV_FINISH object:nil];</code></pre></div>

<p>其他推送</p>

<p>排队数</p>

<div><pre><code class="language-none">[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(customQueue:) name:CUSTOMSRV_QUEUENUM object:nil];</code></pre></div>

<p>坐席信息</p>

<div><pre><code class="language-none">[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(customAgentMessage:) name:CUSTOMSRV_AGENT object:nil];</code></pre></div>

<p>满意度</p>

<div><pre><code class="language-none">[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(customInvestigate) name:CUSTOMSRV_INVESTIGATE object:nil];</code></pre></div>

<p>专属坐席未在线</p>

<div><pre><code class="language-none">[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(customVIP) name:CUSTOMSRV_VIP object:nil];</code></pre></div>

<h3 id="toc_18">4.6 坐席信息</h3>

<table>
<thead>
<tr>
<th>Object</th>
<th>说明</th>
<th style="text-align: center">备注</th>
</tr>
</thead>

<tbody>
<tr>
<td>exten</td>
<td>坐席工号</td>
<td style="text-align: center">例：7000、8000</td>
</tr>
<tr>
<td>name</td>
<td>坐席名称</td>
<td style="text-align: center">后台未配置显示工号</td>
</tr>
<tr>
<td>icon_url</td>
<td>坐席头像</td>
<td style="text-align: center">后台未配置没有值</td>
</tr>
<tr>
<td>type</td>
<td>类型</td>
<td style="text-align: center">robot（机器人）claim（人工）</td>
</tr>
</tbody>
</table>

<h3 id="toc_19">4.7 消息结构</h3>

<table>
<thead>
<tr>
<th>Object</th>
<th>说明</th>
<th style="text-align: center">备注</th>
</tr>
</thead>

<tbody>
<tr>
<td>_id</td>
<td>消息ID</td>
<td style="text-align: center">记录每条消息的ID</td>
</tr>
<tr>
<td>device</td>
<td>设备类型</td>
<td style="text-align: center">如：iphone5s、iphone6</td>
</tr>
<tr>
<td>message</td>
<td>消息内容</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>messageType</td>
<td>消息类型</td>
<td style="text-align: center">如：text、image、voice、file、iframe(小网页)、richText(富文本)、Card(商品展示)、cardInfo(商品详情)</td>
</tr>
<tr>
<td>platform</td>
<td>平台类型</td>
<td style="text-align: center">如：iOS、Android</td>
</tr>
<tr>
<td>sessionId</td>
<td>查询消息的ID</td>
<td style="text-align: center">不同用户的sessionId不同、根据sesssionId查询数据库消息</td>
</tr>
<tr>
<td>accessid</td>
<td>查询消息的accessid</td>
<td style="text-align: center">AppKey下的全部数据,可查看该用户的同一个AppKey下的全部数据库消息</td>
</tr>
<tr>
<td>createTime</td>
<td>消息时间</td>
<td style="text-align: center">创建消息的时间</td>
</tr>
<tr>
<td>fromType</td>
<td>消息来源</td>
<td style="text-align: center">自己发送的为0、接收的消息为1</td>
</tr>
<tr>
<td>status</td>
<td>消息发送状态</td>
<td style="text-align: center">发送成功为：0、发送失败为：1、正在发送中：2</td>
</tr>
<tr>
<td>recordSeconds</td>
<td>录音时间</td>
<td style="text-align: center">语音消息录音时长</td>
</tr>
<tr>
<td>localFilePath</td>
<td>本地文件路径</td>
<td style="text-align: center">文件上传或者下载后本地存储路径, 沙盒相对路径, 如：</td>
</tr>
<tr>
<td>remoteFilePath</td>
<td>远程文件路径</td>
<td style="text-align: center">存储文件的网络路径，可以通过该路径下载各类文件</td>
</tr>
<tr>
<td>fileName</td>
<td>文件名</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>fileSize</td>
<td>文件大小</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>mp3FileSize</td>
<td>mp3消息类型文件大小</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>downloadState</td>
<td>下载状态</td>
<td style="text-align: center">已下载：0, 未下载：1, 下载中：2</td>
</tr>
<tr>
<td>width</td>
<td>iframe类型webView宽度</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>height</td>
<td>iframe类型webView高度</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>agentExten</td>
<td>坐席工号</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>agentName</td>
<td>坐席名称</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>agentIcon</td>
<td>坐席头像</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>isRobot</td>
<td>机器人消息</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>robotType</td>
<td>机器人类型</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>robotId</td>
<td>机器人id</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>isUseful</td>
<td>机器人帮助状态</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>questionId</td>
<td>机器人问题ID</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>richTextUrl</td>
<td>富文本地址</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>richTextPicUrl</td>
<td>图片地址</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>richTextTitle</td>
<td>标题</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>richTextDescription</td>
<td>描述</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>cardImage</td>
<td>商品信息左侧图片</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>cardHeader</td>
<td>商品信息标题</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>cardSubhead</td>
<td>商品信息副标题</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>cardPrice</td>
<td>商品信息价格</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>cardUrl</td>
<td>商品信息地址</td>
<td style="text-align: center"></td>
</tr>
</tbody>
</table>

<h3 id="toc_20">4.8 获取未读消息数</h3>

<div><pre><code class="language-none">此接口Appkey、userName、userId必须与注册用的保持一致

[QMConnect sdkGetUnReadMessage:@&quot;AppKey&quot;    userName:@&quot;userName&quot; userId: @&quot;userId&quot; successBlock:^(NSInteger) {
    // 获取未读消息数成功
} failureBlock:^{
    // 获取未读消息数失败
}];</code></pre></div>

<p><font color=red>获取未读消息数的AppKey、userName、userId必须和注册的保持一致</font></p>

<h3 id="toc_21">4.9 发送消息</h3>

<p>发送文本消息  </p>

<div><pre><code class="language-none">[QMConnect sendMsgText:@&quot;文本消息&quot; successBlock:^{
    // 文本消息发送成功
} failBlock:^{
    // 文本消息发送失败
}];</code></pre></div>

<p>发送语音消息  </p>

<div><pre><code class="language-none">[QMConnect sendMsgAudio:@&quot;录音文件名&quot; duration:@&quot;录音时长&quot; successBlock:^{
    // 语音消息发送成功
} failBlock:^{
    // 语音消息发送失败
}];</code></pre></div>

<p>发送图片消息</p>

<div><pre><code class="language-none">[QMConnect sendMsgPic:image对象 successBlock:^{
   // 图片发送成功
} failBlock:^{
   // 图片发送失败
}];</code></pre></div>

<p>发送文件消息</p>

<div><pre><code class="language-none">[QMConnect sendMsgFile:@&quot;文件名字&quot; filePath:@&quot;文件路径&quot; fileSize:@&quot;文件大小&quot; progressHander:^(float progress) {
    // 文件上传进度回调
} successBlock:^{
    // 文件上传成功
} failBlock:^{
   // 文件上传失败
}];</code></pre></div>

<p>发送卡片消息</p>

<div><pre><code class="language-none">[QMConnect sendMsgCardInfo:dic successBlock:^{
    商品信息发送成功
} failBlock:^{
    商品信息发送失败
}];</code></pre></div>

<p>消息重发</p>

<div><pre><code class="language-none">[QMConnect resendMessage:消息实例 successBlock:^{
    // 重新发送成功
} failBlock:^{
    // 重新发送失败
}];</code></pre></div>

<h3 id="toc_22">4.10 数据库操作</h3>

<p>获取同一个accessId下数据库的全部信息,参数number为每次从数据库取回的消息条数, dataArray为消息数组</p>

<p>[QMConnect getAccessidAllDataFormDatabase:number];</p>

<p>获取单次会话的数据库信息(客服主动关闭后在进入消息清空), 参数number为每次从数据库取回的消息条数, dataArray为消息数组</p>

<div><pre><code class="language-none">dataArray = [QMConnect getDataFromDatabase:number]</code></pre></div>

<p>获取单条消息, 参数为消息ID, 返回值虽然为数组类型, 但只包含一条消息, 一般用于发送失败的消息重发</p>

<div><pre><code class="language-none">dataArray = [QMConnect getOneDataFromDatabase:@&quot;消息ID&quot;]</code></pre></div>

<p>删除单条消息, 参数为消息ID, 只能删除本地数据库中的消息</p>

<div><pre><code class="language-none">[QMConnect removeDataFromDataBase:@&quot;消息ID&quot;];</code></pre></div>

<p>修改语音状态接口,参数为消息ID</p>

<div><pre><code class="language-none">[QMConnect changeAudioMessageStatus:@&quot;消息ID&quot;];</code></pre></div>

<p>撤回消息接口,该接口只用于客服撤回消息</p>

<div><pre><code class="language-none"> [QMConnect changeDrawMessageStatus:@&quot;消息ID&quot;];</code></pre></div>

<p>查询MP3类型文件的消息的大小</p>

<div><pre><code class="language-none">[QMConnect queryMp3FileMessageSize:@&quot;消息ID&quot;];</code></pre></div>

<p>修改MP3类型文件的消息的大小</p>

<div><pre><code class="language-none">[QMConnect changeMp3FileMessageSize:@&quot;消息ID&quot; fileSize:@&quot;文件大小&quot;];</code></pre></div>

<p>插入商品信息卡片消息, 进入客服界面会出现该商品的消息</p>

<div><pre><code class="language-none">[QMConnect insertCardInfoData:消息字典];</code></pre></div>

<p>删除商品信息卡片消息</p>

<div><pre><code class="language-none"> [QMConnect deleteCardTypeMessage];</code></pre></div>

<p>修改商品信息卡片消息时间</p>

<div><pre><code class="language-none">[QMConnect changeCardTypeMessageTime:消息时间];</code></pre></div>

<h3 id="toc_23">4.11 是否启用机器人</h3>

<p>在线客服包含机器人客服和人工客服, 如配置有机器人客服, 如没配置直接进入人工</p>

<div><pre><code class="language-none">[QMConnect allowRobot];</code></pre></div>

<h3 id="toc_24">4.12 转人工服务</h3>

<div><pre><code class="language-none">[QMConnect sdkConvertManual:^{
   // 转人工客服成功
} failBlock:^{
   // 转人工客服失败
}];</code></pre></div>

<p>如未配置机器人客服不需要调用此接口, 转人工客服失败, 则直接跳转至留言界面或退出</p>

<h3 id="toc_25">4.13 授权其他坐席</h3>

<p>专属坐席未在线的情况下，是否接受其他坐席的服务</p>

<div><pre><code class="language-none">[QMConnect sdkAcceptOtherAgentWithPeer:self.peerId successBlock:^{
    // 授权成功
    // 需要再次调用beginSession接口
} failBlock:^{
    // 授权失败
}];</code></pre></div>

<h3 id="toc_26">4.14 获取评价信息</h3>

<div><pre><code class="language-none">[QMConnect sdkGetInvestigate:^(NSArray * _Nonnull investigateArray) {
    // 获取评价信息成功
} failureBlock:^{
    // 获取评价信息失败
}];</code></pre></div>

<h3 id="toc_27">4.15 提交评价</h3>

<div><pre><code class="language-none">[QMConnect sdkSubmitInvestigate:@&quot;评价名称&quot; value:@&quot;评价编号&quot; successBlock:^{
    // 评价成功
} failBlock:^{
    // 评价失败
}];</code></pre></div>

<h3 id="toc_28">4.16 机器人帮助评价</h3>

<div><pre><code class="language-none">[QMConnect sdkSubmitRobotFeedback:isUseful questionId:@&quot;机器人问题id&quot; messageId:@&quot;消息ID&quot; robotType:@&quot;机器人消息类型&quot; robotId:@&quot;机器人ID&quot; successBlock:^{
    //机器人帮助评价成功 
} failBlock:^{
   //机器人帮助评价失败
}];</code></pre></div>

<h3 id="toc_29">4.17 提交留言</h3>

<div><pre><code class="language-none">[QMConnect sdkSubmitLeaveMessage:@&quot;部门ID&quot; phone: @&quot;联系电话&quot; Email:@&quot;联系邮箱&quot; message:@&quot;留言内容&quot; successBlock:^{
    // 留言成功
} failBlock:^{
    // 留言失败
}];</code></pre></div>

<h3 id="toc_30">4.18 关闭服务</h3>

<div><pre><code class="language-none">[QMConnect logout];</code></pre></div>

<h3 id="toc_31">4.19 下载文件</h3>

<div><pre><code class="language-none">[QMConnect downloadFileWithMessage:文件消息实例 localFilePath:@&quot;存储文件的路径&quot; progressHander:^(float progress) {
    // 文件下载进度
} successBlock:^{
    // 文件下载成功
} failBlock:^(NSString * _Nonnull error) {
    // 文件下载失败
}];</code></pre></div>

<h3 id="toc_32">4.20 留言功能</h3>

<p>留言功能</p>

<div><pre><code class="language-none">[QMConnect allowedLeaveMessage]</code></pre></div>

<p>留言提示信息</p>

<div><pre><code class="language-none">[QMConnect leaveMessageAlert]</code></pre></div>

<p>留言内容信息</p>

<div><pre><code class="language-none">[QMConnect leaveMessagePlaceholder]</code></pre></div>

<p>自动关闭会话功能</p>

<div><pre><code class="language-none">[QMConnect allowedBreakSession]</code></pre></div>

<p>自动关闭会话提示语</p>

<div><pre><code class="language-none">[QMConnect breakSessionAlert]</code></pre></div>

<p>自动关闭会话时间</p>

<div><pre><code class="language-none">[QMConnect breakSessionDuration]</code></pre></div>

<p>自动关闭提醒时间</p>

<div><pre><code class="language-none">[QMConnect breakSessionAlertDuration]</code></pre></div>

<h3 id="toc_33">4.21 定时提醒和关闭会话(1.9.0以后不建议使用此接口)</h3>

<div><pre><code class="language-none">QMConnect sdkChatTimerBreaking:^(NSDictionary * _Nonnull) {
    //获取定时提示信息成功
} failBlock:^{
    //获取定时提示消息失败
}];</code></pre></div>

<h3 id="toc_34">4.22 更新deviceToken</h3>

<p>每次启动应用都需要重新设置</p>

<div><pre><code class="language-none"> [QMConnect setServerToken:deviceToken];</code></pre></div>

<h2 id="toc_35">常见问题</h2>

<h3><a href="#jumpto1">集成问题</a></h3>
<h3><a href="#jumpto2">编译问题</a></h3>
<h3><a href="#jumpto3">发布问题</a></h3>  
<h3><a href="#jumpto4">逻辑问题</a></h3>
<h3><a href="#jumpto5">使用问题</a></h3>
<h3><a href="#jumpto6">推送问题</a></h3>
<h3><a href="#jumpto7">H5页面问题</a></h3>

<h3><div id="jumpto1">集成问题</div></h3>

<ol>
<li>不显示表情<br></li>
</ol>

<p>解决方案: </p>

<ul>
<li>查看demo导入工程的时候是否将表情图片同时导入</li>
<li>查看对应表情的expressionImage.plist文件是否已经导入, 该文件在第三方库ExpressionView文件夹下</li>
<li><p>查看显示表情的Cell中是否支持表情的富文本, demo中使用的是EmojiLabel第三方库</p></li>
</ul>

<ol>
<li><p>第三方库冲突</p></li>
</ol>

<ul>
<li>demo中的第三方库冲突可以二选一，将其中一个重复的删除</li>
<li><p>SDK中使用了FMDB, Qiniu, AFNetworking等第三方库, 容易出现冲突的是AFNetworking出现冲突时可以将其中冲突的类名改写一下</p></li>
</ul>

<ol>
<li><p>使用iphone真机注册失败</p></li>
</ol>

<ul>
<li><p>在蜂窝移动网络中，打开对应的网络管理</p></li>
</ul>

<ol>
<li><p>pod search 不到最新的库</p></li>
</ol>

<ul>
<li>更新本地的缓存 pod repo update<br></li>
<li><p>检查pod版本</p></li>
</ul>

<ol>
<li><p>SDK界面部分显示成英文 </p></li>
</ol>

<ul>
<li><p>SDK支持国际化,导入代码的同时，需要在工程中建立创建多语言文件，Demo中的多语言文件名称为:
<font color=red>Localizable.strings</font></p></li>
</ul>

<ol>
<li><p>已接入人工,导航栏仍显示 <font color=red>等待接入</font> (2.7.0版本之前显示的是等待连接)</p></li>
</ol>

<ul>
<li>因为客服系统设置访客回复消息后才算接入会话, 修改方式看下图</li>
</ul>

<p><img src="https://fs-kefu-sdk.7moor.com/dengdai.png" alt="Alt text"></p>

<h3><div id="jumpto2">编译问题</div></h3>

<ol>
<li>Library not loaded<br></li>
</ol>

<p>集成SDK后工程run的时候crash, 提示Library not loaded, 主要原因是库文件没有加载成功, 错误如下
<img src="http://7xqpis.com1.z0.glb.clouddn.com/imageNotFound.png" alt="Alt text"></p>

<p>解决方案: </p>

<ul>
<li><font color=red>检查SDK版本和Xcode版本，2.5.0以上的SDK只支持 &gt;= Xcode9.3的版本</font> </li>
<li>Build Settings-&gt;Build Options-&gt;Always Embed Swift Standard Libraries = Yes</li>
<li>General-&gt;Embedded Binaries 点击’+‘号，将QMChatSDK.framework、FMDB.framework和Qiniu.framework三个库添加进入</li>
<li>缓存导致，删除相应的库文件重新导入</li>
<li>如果是pod引入出现此问题,在Podfile文件中添加 use<em>frameworks! (如果pod的第三方库较多, 请先查明use</em>frameworks!用法)</li>
</ul>

<p><font color=red>注: 建议多使用clean或重新导入包, 2.5.0(包含2.5.0)以上版本只支持Xcode9.3以上的版本(包含Xcode9.3)</font></p>

<ol>
<li>模拟器报错</li>
</ol>

<p><img src="https://fs-kefu-sdk.7moor.com/symbol.tiff" alt="Alt text"></p>

<ul>
<li>检查使用的库是否是文件夹中真机+模拟器的库</li>
<li>检查是否导入libicucore.tbd库</li>
</ul>

<h3><div id="jumpto3">发布问题</div></h3>

<ol>
<li>x86_64,i386<br></li>
</ol>

<p>集成了SDK的应用发布到AppStore时报错，如下</p>

<p><img src="http://7xqpis.com1.z0.glb.clouddn.com/submitAppStore1.png" alt="Alt text"></p>

<p>解决方案:</p>

<ul>
<li><p>QMChatSDK库文件有两种, 一种支持真机和模拟器, 一种只支持真机, 如果测试需要用到模拟器, 测试时可以用前一种, 如果不用模拟器全程只用真机, 建议用只支持真机的库, 在真机文件夹下, <font color=red>发布应用时不能使用同时支持真机和模拟器的库文件, 否则会报错</font></p></li>
<li><p>使用脚本打包前去掉不需要的架构(推荐)</p>

<p>具体参照demo Build Phases</p></li>
<li><p>如果使用带视频的SDK包上传App Store报错, QMVSDK.framework这个包不能放在General -&gt; Embedded Binaries 下,其他几个保留,在Linked Frameworks and Libraries 下几个包都需要保留</p></li>
</ul>

<h3><div id="jumpto4">逻辑问题</div></h3>

<ol>
<li><p>跳转至聊天界面</p></li>
</ol>

<ul>
<li><p>现象一 跳转至聊天界面后，网络断开重新连接，又跳转一次聊天界面  </p>

<p>解决方案： 跳转界面根据注册SDK成功后，接收到相应的通知进行跳转，网络波动会导致后台重新连接，再次发出连接成功的通知，所以在跳转界面进行判断，在聊天界面的时候，接收连接成功的通知直接return不会跳转</p></li>
<li><p>现象二 应用将要进入后台的时候调用注销接口, 返回前台后收不到消息</p>

<p>解决方案： 需要重新注册和之前注册的AppKey、userName、userId需要保持一致</p></li>
</ul>

<h3><div id="jumpto5">使用问题</div></h3>

<ul>
<li><p>客服发送消息用户无法收到</p>

<p>解决方案：登录后台系统需要使用google浏览器</p></li>
<li><p>客服不在线、用户的会话接入到了该客服</p>

<p>解决方案：客服登陆前、确保所有的待处理会话都已经结束</p></li>
</ul>

<h3><div id="jumpto6">推送问题</div></h3>

<p>1、 上传证书不离线推送</p>

<ul>
<li><p>检查客服系统中是否配置过 p12 文件，此证书是否与此app的 Bundle Identifier 关联的推送证书</p></li>
<li><p>检查证书的线上、测试环境是否跟客服系统中配置的相同</p></li>
<li><p>检查 appName 是否和客服系统中填写的“App名称”一致</p></li>
<li><p>检查 provision profile 是否包含了推送证书</p></li>
<li><p>检查代码调试是否可以获取到 devicetoken</p></li>
<li><p>检查工程中的 Capablities 中是否开启了 Push Notifications</p></li>
</ul>

<p>2、上传URL接收不到离线推送</p>

<ul>
<li>消息以json数据发送给客服系统中配置的URL，检查是否收到json数据</li>
</ul>

<p>3、SDK以离线 app在线时接收到离线推送提示处理</p>

<ul>
<li>详见AppDelegate</li>
</ul>

<h3><div id="jumpto7">H5页面问题</div></h3>

<ol>
<li><p>H5链接页面不显示</p>

<div><pre><code class="language-none">NSString *filePath = @&quot;kf.7moor.com&quot;;
NSString *encodedString = [filePath stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
NSURL *weburl = [NSURL URLWithString:encodedString];
[webView loadRequest:[NSURLRequest requestWithURL:weburl]];</code></pre></div></li>
<li><p>H5页面点击图片或文件不跳转</p>

<div><pre><code class="language-none">- (void)dismissViewControllerAnimated:(BOOL)flag completion:(void (^)(void))completion{
  if (self.presentedViewController != nil) {
         [super dismissViewControllerAnimated:flag completion:completion];
    }
}</code></pre></div></li>
<li><p>tabBar遮挡发送按钮</p></li>
</ol>

<ul>
<li> 查看webView的frame的高度</li>
</ul>

<h2 id="toc_36">代码改动页面</h2>

<h4 id="toc_37">2.7.0代码改动页面</h4>

<ul>
<li>QMChatRoomViewController</li>
<li>QMChatRoomCardCell</li>
<li>QMChatRoomRichTextCell</li>
<li>QMChatRoomBaseCell(改动背景颜色和更换了背景图片)</li>
</ul>

<h2 id="toc_38">更新日志</h2>

<h4 id="toc_39">版本更新2.7.0: 2018-07-01</h4>

<ul>
<li>新增未读消息数功能</li>
<li>新增商品信息消息展示和发送功能</li>
<li>新增获取同一个AppKey下的全部消息功能</li>
</ul>

<h4 id="toc_40">版本更新2.6.1: 2018-6-20</h4>

<ul>
<li>支持Xcode9.4.1， iOS 11.4</li>
</ul>

<h4 id="toc_41">版本更新2.6.0: 2018-05-31</h4>

<ul>
<li>支持上传证书离线消息推送</li>
<li>支持主动会话</li>
</ul>

<h4 id="toc_42">版本更新2.5.3: 2018-05-18</h4>

<ul>
<li>支持国际化</li>
<li>mp3文件以语音形式直接播放</li>
</ul>

<h4 id="toc_43">版本更新2.5.1: 2018-04-10</h4>

<ul>
<li>修复已知问题</li>
</ul>

<h4 id="toc_44">版本更新2.5.0: 2018-04-4</h4>

<ul>
<li>新增消息撤回功能</li>
<li>客服正在输入提示</li>
<li>支持Xcode9.3</li>
</ul>

<h4 id="toc_45">版本更新2.4.0: 2018-03-16</h4>

<ul>
<li>新增日程管理功能</li>
<li>新增富文本消息类型</li>
</ul>

<h4 id="toc_46">版本更新2.3.0: 2018-02-08</h4>

<ul>
<li>新增专属坐席功能</li>
<li>分离机器人消息显示</li>
</ul>

<h4 id="toc_47">版本更新2.2.0: 2017-11-17</h4>

<ul>
<li>适配iPhone X</li>
<li>增加机器人回复有无帮助选项</li>
<li>包名更新为QMChatSDK</li>
<li>更新Qiniu第三方库至7.1.8版本</li>
<li>支持 Cocoapods</li>
<li>修复发送视频文件失败的问题</li>
</ul>

<h4 id="toc_48">版本更新2.1.0: 2017-09-22</h4>

<ul>
<li>支持xcode9，iOS11</li>
</ul>

<h4 id="toc_49">版本更新2.0.0: 2017-09-11</h4>

<ul>
<li>在线客服全新界面</li>
</ul>

<h4 id="toc_50">版本更新1.9.0: 2017-08-02</h4>

<ul>
<li>更新SDK依赖库，FMDB、Qiniu</li>
<li>增加获取后台配置信息接口</li>
<li>优化Demo</li>
</ul>

<h4 id="toc_51">版本更新1.8.0: 2017-06-08</h4>

<ul>
<li>支持IPv6</li>
<li>优化发送表情功能</li>
<li>更新第三方库</li>
</ul>

<h4 id="toc_52">版本更新1.7.0: 2017-03-30</h4>

<ul>
<li>支持xcode8.3 iOS10.3</li>
</ul>

<h4 id="toc_53">版本更新1.6.0: 2017-01-11</h4>

<ul>
<li>新增推送在线客服工号</li>
<li>新增定时提醒和关闭会话</li>
</ul>

<h4 id="toc_54">版本更新1.5.0: 2016-11-23</h4>

<ul>
<li>新增iframe消息类型</li>
</ul>

<h4 id="toc_55">版本更新1.4.0: 2016-11-11</h4>

<ul>
<li>支持xcode8.1 iOS10.1</li>
</ul>

<h4 id="toc_56">版本更新1.3.0: 2016-08-20</h4>

<ul>
<li>新增文件消息类型，支持文件消息发送，文件下载</li>
<li>新增图片消息发送接口(参数为本地图片相对路径)</li>
<li>消息结构新增字段(localFilePath、remoteFilePath、fileName、fileSize、downloadState)</li>
<li>优化聊天界面<br>
注: 已集成SDK的客户更新需要对文件管理的消息类型做相应处理，否则直接更新SDK会导致崩溃</li>
</ul>

<h4 id="toc_57">版本更新1.2.2: 2016-06-20</h4>

<ul>
<li>更新七牛SDK，支持IPv6</li>
<li>对特殊字符进行处理</li>
<li>使用IMSDK依赖Qiniu，FMDB第三方库<br></li>
</ul>

<h4 id="toc_58">版本更新1.2.1: 2016-04-25</h4>

<ul>
<li>SDK支持iOS9.3</li>
<li>修复SDK表情库与后台不匹配</li>
<li>SDK支持真机和模拟器合并包<br></li>
</ul>

<h4 id="toc_59">版本更新1.2.0: 2016-03-25</h4>

<ul>
<li>SDK新增删除一条数据库信息接口(只能删除本地数据库消息) </li>
<li>SDK新增满意度评价推送(通知方式新增一条本地消息，消息内容为获取的本地评价信息) </li>
<li>SDK新增多技能组获取接口(开始会话前可以选择相应的技能组进行咨询) </li>
<li>SDK新增获取满意度调查信息接口(异步请求满意度调查选项,移除之前的获取本地满意度调查接口,用户可根据获取到的数据自行缓存)</li>
<li>SDK新增设置服务器地址接口(自建客户可设置此接口,连接本地服务器)</li>
</ul>

<h4 id="toc_60">版本更新1.1.1: 2016-02-03</h4>

<ul>
<li>新增SDK注销接口(使用demo需在AppDelegate中添加全局变量)<br></li>
</ul>

<h4 id="toc_61">版本更新1.1.0: 2015-12-22</h4>

<ul>
<li>修复已知的BUG</li>
<li>SDK新增接收图片消息</li>
</ul>




</body>

</html>
